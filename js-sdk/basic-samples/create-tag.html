<!--
Example: Create tag

This example demonstrates how to create a new custom tag in DocSpace using the JavaScript SDK.

Using methods:
- DocSpace.SDK.initManager (https://api.onlyoffice.com/docspace/javascript-sdk/usage-sdk/classes/SDK/#initmanager)
- manager.createTag (https://api.onlyoffice.com/docspace/javascript-sdk/usage-sdk/classes/SDKInstance/#createtag)
-->

<!-- Step 1: HTML Setup -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <base href="{PORTAL_SRC}/" />
    <meta charset="UTF-8" />

    <meta name="example-title" content="Create tag" />
    <meta
      name="example-description"
      content="Create a new custom tag in DocSpace using the JavaScript SDK and show the created tag details."
    />
    <meta name="example-group" content="basic" />

    <title>Create Tag</title>

    <script src="{PORTAL_SRC}/static/scripts/sdk/2.0.0/api.js"></script>

    
  
    <!-- App styles -->
    <script>
      (function () {
        var link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = new URL("../assets/css/style.css", window.location.href).toString();
        document.head.appendChild(link);
      })();
    </script>

</head>

  <body class="ex-create-tag">
    <iframe id="ds-manager-frame"></iframe>

    <div class="page">
      <div class="card">
        <div class="title">Create tag</div>
        <p class="desc">
          Enter a tag name and create it using the DocSpace SDK. The created tag details will be shown below.
        </p>

        <label for="tagName">Tag name</label>
        <input id="tagName" type="text" placeholder="tag-123" autocomplete="off" />

        <div class="row">
          <button id="createBtn" type="button" disabled>Create Tag</button>
          <button id="autoBtn" type="button" class="btn-secondary" disabled>Generate name</button>
          <div class="hint" id="status">Preparing SDK…</div>
        </div>

        <div class="result" id="result">
          <div class="result-title">Created tag</div>
          <div class="kv" id="kv"></div>
        </div>
      </div>
    </div>

    <script>
      const tagNameEl = document.getElementById("tagName");
      const createBtn = document.getElementById("createBtn");
      const autoBtn = document.getElementById("autoBtn");
      const status = document.getElementById("status");
      const result = document.getElementById("result");
      const kv = document.getElementById("kv");

      let sdkReady = false;

      const manager = DocSpace.SDK.initManager({
        frameId: "ds-manager-frame",
        width: "0",
        height: "0",
        theme: "base",
        events: {
          onAppReady: () => {
            sdkReady = true;
            createBtn.disabled = false;
            autoBtn.disabled = false;
            status.textContent = "SDK ready.";
          },
          onAppError: () => {
            status.textContent = "SDK error. Please check portal URL / access.";
          }
        }
      });

      function updateCreateState() {
        const name = (tagNameEl.value || "").trim();
        createBtn.disabled = !sdkReady || !name;
      }

      function renderTag(tag) {
        kv.innerHTML = "";

        const id = tag?.id ?? "";
        const name = tag?.name ?? tag?.title ?? "";
        const color = tag?.color ?? "";

        const rows = [
          ["ID", String(id)],
          ["Name", String(name)]
        ];

        if (color) rows.push(["Color", String(color)]);

        for (const [k, v] of rows) {
          const kEl = document.createElement("div");
          kEl.className = "muted";
          kEl.textContent = k;

          const vEl = document.createElement("div");
          vEl.textContent = v;

          kv.appendChild(kEl);
          kv.appendChild(vEl);
        }

        result.style.display = "block";
      }

      autoBtn.onclick = () => {
        tagNameEl.value = `tag-${Date.now().toString()}`;
        updateCreateState();
      };

      tagNameEl.addEventListener("input", updateCreateState);

      createBtn.onclick = async () => {
        const name = (tagNameEl.value || "").trim();
        if (!sdkReady || !name) return;

        createBtn.disabled = true;
        autoBtn.disabled = true;
        status.textContent = "Creating tag…";
        result.style.display = "none";

        try {
          const created = await manager.createTag(name);
          renderTag(created);
          status.textContent = "Done.";
        } catch (e) {
          status.textContent = "Failed to create tag.";
        } finally {
          autoBtn.disabled = false;
          updateCreateState();
        }
      };
    </script>
  </body>
</html>
